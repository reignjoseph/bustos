<div class="employernotification-container" style="display: none;">
    <h2>NOTIFICATION</h2>
    <table id="applicant-list" border="1" style="border-collapse: collapse; width: 100%;">
        <!-- Table Headers and Applicants will be dynamically inserted here -->
    </table>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    fetchApplicants();
});

function fetchApplicants() {
    $.ajax({
        url: '/fetch_applicants',
        method: 'GET',
        success: function(data) {
            console.log("Received data: ", data);

            if (Array.isArray(data)) {
                // Add table headers
                let applicantHtml = `
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Contact</th>
                            <th>Form</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                `;

                // Loop through applicants and create table rows
                data.forEach(applicant => {
                    applicantHtml += `
                        <tr>
                            <td>${applicant.jobseeker_name}</td>
                            <td>${applicant.email}</td>
                            <td>${applicant.contact_no}</td>
                            <td><a href="/static/${applicant.form}" target="_blank">View Resume</a></td>
                            <td>${applicant.status}</td>
                            <td>
                                <input type="button" value="APPROVE">
                                <input type="button" value="DENIED">
                            </td>
                        </tr>
                    `;
                });

                applicantHtml += `</tbody>`;

                // Insert the generated HTML into the table
                document.getElementById('applicant-list').innerHTML = applicantHtml;
                document.querySelector('.employernotification-container').style.display = 'block';
            } else {
                console.error("Error: Expected an array, but received:", data);
            }
        },
        error: function(xhr, status, error) {
            console.error("Error: " + error + " Status: " + status);
            alert("An error occurred while fetching applicants. Please try again later.");
        }
    });
}
</script>
