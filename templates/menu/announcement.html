<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/announcement.css">
    <!-- Bootstrap and custom JavaScript -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    <script src="/static/js/script.js" defer=""></script>
    <title>Home</title>
    <link rel="icon" href="static/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <header style="padding: 10px;">
        <div class="container" style="max-width: -webkit-fill-available;">
            <div class="d-flex justify-content-between align-items-center py-2">
                    <a href="/" class="logo-box">
                        <img src="/static/images/jobahanap.png" style="max-width: 200px;" alt="Logo">
                    </a>
                <button class="menu-icon btn btn-primary d-md-none" onclick="toggleMenu()">â˜°</button>
                <div class="boxes-container close" id="boxes-container">
                    <a href="/" class="box">
                        <img class="image" src="/static/images/home.png" alt="Logo">
                    Home</a>
                    <a href="/announcement" class="box">
                        <img class="image" src="/static/images/announcement.png" alt="Logo">
                    Announcement</a>
                    <a href="/about#" class="box">
                        <img class="image" src="/static/images/aboutus.png" alt="Logo">
                    About Us</a>
                    <a href="/about#contact" class="box">
                        <img class="image" src="/static/images/contactus.png" alt="Logo">
                    Contact Us</a>
                    <a href="/signin" class="box">
                        <img class="image" src="/static/images/signin.png" alt="Logo">
                    Sign In</a>

                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="container" id="announcements-container" style="display: grid;     grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); margin-top: 4em;">
            <!-- Announcements will be dynamically loaded here -->
        </div>




        
    </main>
</body>
</html>
<script>
    $(document).ready(function() {
    // Function to fetch announcements
    function fetchAnnouncements() {
        $.ajax({
            url: '/fetch_announcements',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
    $('#announcements-container').empty(); // Clear previous data

    if (Array.isArray(response.announcements)) {
        response.announcements.forEach(function(announcement) {
            // Create card structure for each announcement
            var card = `
            <div class="card_announce">
                <img src="${announcement.image}" alt="Announcement Image" class="card-img">
                <div class="card-content">
                    <h2>${announcement.what}</h2>
                    <p><strong>Where:</strong> ${announcement.where}</p>
                    <p><strong>When:</strong> ${announcement.when}</p>
                    <p><strong>Requirement:</strong> ${announcement.requirement}</p>
                    <p><strong>Description:</strong> ${announcement.description}</p>
                    <button style="margin: 10px 0px 10px 0px; width:max-content" class="btn btn-primary" onclick="redirectToLearnMore(${announcement.id})">Learn More</button>
                </div>
            </div>`;
            
            $('#announcements-container').append(card);
        });
    } else {
        console.error('Expected an array for announcements, but got:', response);
    }
},
          error: function(err) {
                console.error('Error fetching announcements:', err);
            }
        });
    }

    // Fetch announcements on page load
    fetchAnnouncements();
});
</script>

<script>
    function redirectToLearnMore(announcementId) {
    $.ajax({
        url: '/check_session',
        method: 'GET',
        success: function(response) {
            if (response.logged_in) {
                // If the user is logged in, redirect to /jobseeker
                window.location.href = `/jobseeker`;
            } else {
                // If not logged in, redirect to the sign-in page
                window.location.href = '/signin';
            }
        },
        error: function() {
            console.error('Error checking session status.');
            window.location.href = '/signin';
        }
    });
}
</script>